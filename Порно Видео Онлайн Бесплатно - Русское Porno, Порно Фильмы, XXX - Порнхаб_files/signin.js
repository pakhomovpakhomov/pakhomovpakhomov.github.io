function userSignUpClog(e,i,t,n,s,o){let a=s?"&origin_item_id="+s:"",l=1<n.length?"&origin_url="+encodeURIComponent(n):"",r=1<n.length?"&origin="+t:"",c=o?"&origin_item_variation="+o:"",d="";void 0!==page_params["geo-localization"]&&"all"!==page_params["geo-localization"]&&(d="&geo-localization="+page_params["geo-localization"]);var u="";if(void 0!==page_params&&page_params.subdomain&&"signup-open"==i)switch(page_params.subdomain){case"es":u="&geo-localization=spanish";break;case"jp":u="&geo-location=japan";break;case"it":u="&geo-location=italy";break;case"fr":u="&geo-location=france";break;default:u=""}MG_Utils.ajaxCall({url:e+"/_i?type=event&event="+i+r+l+a+c+d+u,type:"POST",headers:"undefined"!=typeof liuIdOrNull&&liuIdOrNull?{__m:liuIdOrNull}:null})}var extendedPropsForModal={signInUtilModal:null,config:TOP_BODY,show:function(e){e=void 0!==e?e:{},"undefined"!=typeof event&&event.preventDefault(),this.options=e;var i,t,n=document.getElementById("signinModal");if(navigator.userAgent&&navigator.userAgent.match(/PLAYSTATION/))return document.location.assign("http://"+location.hostname+"/login"),!1;"block"===n.style.display&&1!=this.config.shorties||(t=!!(i=document.getElementById("rightMenu"))&&i.querySelector(".closeHamMenu"),i&&MG_Utils.hasClass(i,"active")&&t&&t.click(),this._openModal(e,n),"function"==typeof appendedTasteProfile&&appendedTasteProfile("js-tasteProfileLoginModal"))},_openModal:function(n,e){e&&(this.signInUtilModal=new MG_Modal({content:e,className:"loginModal",afterunload:(t,e)=>{if(MG_Utils.hasClass(e,"updatedModal")){let i=e=>{document.removeEventListener("click",i);e=e.target===t?"outside_modal_window":"button-close-x";userSignUpClog(currentDomain,"signup-aborted",originPart,originUrl,e,newModal)};document.addEventListener("click",i)}}}),this.signInUtilModal)&&(this.newInstance=!1,this.signInUtilModal.openModal((e,i)=>{var t;this.container=i,this._toggleModalContent(this.container,n),n.subscribe&&(i=this.container.querySelector(".js-loginForm"),(t=document.createElement("input")).type="hidden",t.name="subscribe",t.value=1,i.appendChild(t)),n.shortiesInputVideoId&&(i=this.container.querySelector(".js-loginForm"),(t=document.createElement("input")).type="hidden",t.name="videoId",t.value=n.shortiesInputVideoId,i.appendChild(t)),this.init(),this.showCaptcha&&(this._initializeCaptcha(),this.toggleButtonDisable(!0)),this.newInstance=!0}),e=document.querySelectorAll(".js_closeModal"),MG_Utils.addEventHandler(e,"click",()=>{this.signInUtilModal.closeModal(),this.recaptchaCompleted=!1,this.container=null}),this.newInstance||this._toggleModalContent(this.container,n))},_toggleModalContent:function(e,i){var t=e.querySelector(".signInWrap"),n=e.querySelector(".signUpWrap");t&&n&&("signIn"===i.step||void 0===i.step?(this._resetForms(t),MG_Utils.addClass(n,"displayNone"),MG_Utils.removeClass(t,"displayNone"),"undefined"!=typeof phCustomEvent&&phCustomEvent.dispatch("initSignUp",!1)):"signUp"!==i.step&&"signUpLikedVideo"!==i.step&&"signUpVideoLikedWatchPage"!==i.step||(window.dataLayer.push({event:"signup_impression",location:"signUpLikedVideo"===i.step?"liked_videos_page_cta":"signUpVideoLikedWatchPage"===i.step?"liked_videos_snackbar":"undefined"}),MG_Utils.removeClass(n,"displayNone"),MG_Utils.addClass(t,"displayNone"),MG_Utils.addClass(e,"updatedModal"),"undefined"!=typeof phCustomEvent&&phCustomEvent.dispatch("initSignUp",!0)))},_resetForms:function(e){var i,t,n=e.getAttribute("data-step");n&&"signIn"===n&&(n=e.querySelector("form"),i=e.querySelector("#signinSubmit"),t=e.querySelector(".signinError"),e=e.querySelectorAll("input"),n&&n.reset(),i&&i.setAttribute("disabled","disabled"),i&&MG_Utils.addClass(i,"disabled"),e&&MG_Utils.removeClassMultiple(e,"signin_error"),t)&&(t.innerText="")},_initializeCaptcha:function(){try{var e=this.container.querySelector(".g-recaptcha");null!=typeof CaptachaComponents&&e&&CaptachaComponents.registerComponent(e,this.captchaAcknowledgement)}catch(e){}},redirectFromResponse:function(e){var i=this.container.querySelector("#signinLoggingin"),t=this.container.querySelector(".js-signinUsername"),n=this.container.querySelector(".js-signinPassword"),s=document.getElementsByClassName("ph-icon-error"),o=this.container.querySelector(".signinError");e.redirect?(i.style.display="block",o.style.display="none",MG_Utils.removeClass(t,"signin_error"),MG_Utils.removeClass(n,"signin_error"),MG_Utils.addClassMultiple(s,"displayNone"),void 0!==e.subscribe&&1==e.subscribe?document.querySelector(".subscribeButton button.login").setAttribute("data-login","0"):this.options.callbackCustomRedirect&&"function"==typeof this.options.callbackCustomRedirect?this.options.callbackCustomRedirect(e):document.location.assign(e.redirect)):(o.style.display="block",o.innerHTML=e.message,MG_Utils.addClass(t,"signin_error"),MG_Utils.addClass(n,"signin_error"),MG_Utils.removeClassMultiple(s,"displayNone"),this.toggleButtonDisable(!1))},callbackSuccess:function(t){if("0"==t.premium_redirect_cookie||t.forceRedirect){if(t.showExpiredFreeTrial)return this.premiumModalFromResponse(t);this.redirectFromResponse(t)}else{var e=new Date,e=premiumRedirectCookieURL+(0<premiumRedirectCookieURL.indexOf("?")?"&":"?")+"timestamp="+e.getTime();const i=new XMLHttpRequest;i.withCredentials=!0,i.open("GET",e,!0),i.onreadystatechange=function(){var e,i;4===this.readyState&&200<=this.status&&this.status<400&&(e=this.container.querySelector("#signinLoggingin"),i=this.container.querySelector(".signinError"),t.redirect?(e.style.display="",i.style.display="none",document.location.assign(t.redirect)):(i.style.display="",i.innerHTML=t.message,this.toggleButtonDisable(!1)))},i.send(),i=null}},loginAjaxSuccess:function(e){var i;e.twoStepVerification?(i=this.container.querySelector(".js-loginForm"))&&(MG_Utils.addClass(i,"displayNone"),this.setupTwoStepVerification(e)):e.requireCaptcha?(this.showCaptcha=!0,jQuery(".js-loginForm .signinError").show().html(e.message),this.setupCaptacha()):this.callbackSuccess(e)},initGoogleSso:function(){var e=document.getElementsByTagName("head")[0],i=document.createElement("script"),t=(i.type="text/javascript",i.src="https://accounts.google.com/gsi/client",e.appendChild(i),this);i.onload=function(){google.accounts.oauth2.initTokenClient({client_id:gSSOClientId,scope:"https://www.googleapis.com/auth/userinfo.email",ux_mode:"popup",callback:e=>{t.loginAjax(e.access_token,".loginModal form.js-loginForm")}}).requestAccessToken()}}},signinbox=Object.assign({},Signinbox,extendedPropsForModal);MG_Utils.domReady(function(){document.location.search.match(/showSigninBox=true/i)&&null!=document.getElementById("headerLoginLink")&&signinbox.show();let e=document.getElementById("headerLoginLink"),t=document.querySelector(".profileOptions");if(e&&e.addEventListener("click",function(){t&&(MG_Utils.hasClass(t,"show")?MG_Utils.removeClass(t,"show"):(MG_Utils.addClass(t,"show"),userSignUpClog(currentDomain,"user-menu",originPart,originUrl,"user-menu-icon",newModal)))}),document.addEventListener("click",function(e){var i=e.target;e&&i&&"headerLoginLink"!==i.id&&!MG_Utils.hasClass(i,"selectMenu")&&t&&MG_Utils.removeClass(t,"show"),(MG_Utils.hasClass(i,"closeMTubes")||MG_Utils.hasClass(i,"isVisibleMTubes"))&&"undefined"!=typeof sessionStorage&&null!==sessionStorage.getItem("notLoggedIn")&&sessionStorage.removeItem("notLoggedIn")}),"undefined"!=typeof openSigninModal&&"undefined"!=typeof signinModalMessage){if(!openSigninModal)return;signinbox.show({step:"signIn"});var i=signinbox.container.querySelector(".signinError");i.style.display="block",i.innerHTML=signinModalMessage??""}jQuery(document).on("click","#ssoGoogleSigninButton",function(){signinbox.initGoogleSso()})});