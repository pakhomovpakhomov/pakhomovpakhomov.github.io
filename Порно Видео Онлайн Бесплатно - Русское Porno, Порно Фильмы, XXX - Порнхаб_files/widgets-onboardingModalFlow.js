class OnboardingFlowModal{constructor(){let n=0,t=null,a=!1,s=!0,o=new Event("onboardingFinished"),r=this,l={declineOnBoardingProcessBtn:"js_decline-btn",acceptOnBoardingProcessBtn:"js_goToOnboardingModal",backToCustomizeBtn:"js_backToCustomizeBtn",welcomeModalPopUp:"welcome-onboardinModal",exitConfirmModalPopUp:"exit-onboardingModal",onboardingStepsModalPopUp:"steps-onboardingModal",completedOnboardingModalPopUp:"completed-onboardingModal",stepOne:"stepOne",closeModalBtn:".js_closeModalBtn",stepModal:"stepsModal",nextButton:".js_nextStep",stepOneBtn:"js_stepOneBtn",stepTwoBtn:"js_stepTwoBtn",prevButton:".js_backToPrevStep",nextButtonInactive:".inactive-btn",errorDOFBtn:".error-DOFBtn",doneAllStepsBtn:"js_doneAllSteps",closeAllModalsBtn:".js_closeAllModals",subscribeBtn:".js_subscribeBtn",selectAllPill:".selectAll-pill",modalBackgroundOverlay:".modalBackgroundOverlay",basicInformationBday:document.getElementById("js_basicInformationBday"),day:document.getElementById("js_day"),month:document.getElementById("js_month"),year:document.getElementById("js_year"),country:document.getElementById("js_country"),errorMsg_1:document.getElementById("js_errorMsg_1"),errorMsg_2:document.getElementById("js_errorMsg_2"),errorMsg_3:document.getElementById("js_errorMsg_3"),emailVerificationBanner:document.querySelector(".js-emailBannerOnboarding"),changeUserNameInput:document.getElementById("js_changeYourUserNameInput"),responseMsgWrapper:document.getElementById("js_responseMsg"),userProfileDataUserName:document.querySelector(".js_userName"),exitOnboardingConfirmBtn:"js_confirmExitBtn",today:new Date,fullPageUrl:window.location.href};r.init=function(){r.initGtmEvent("quiz_start"),r.attachEvents(),document.getElementById(l.stepTwoBtn)&&r.showEthnicityAndCategory("women"),userSignUpClog(currentDomain,"onb-flow",originPart||"homepage",l.fullPageUrl,clickedElement,"")},r.gtmHandleButtons=e=>{var t=document.getElementById(l.exitOnboardingConfirmBtn),n=document.getElementById(l.backToCustomizeBtn),a=document.querySelector("."+l.onboardingStepsModalPopUp);MG_Utils.hasClass(a,"is-hidden")||(t.dataset.label="abandon_yes_"+(e+1),n.dataset.label="abandon_continue_"+(e+1))},r.initGtmEvent=function(e){window.dataLayer.push({event:"welcome_quiz",event_label:e})},r.attachEvents=function(){window.addEventListener("beforeunload",e=>{if(a)return e.preventDefault(),e.returnValue=!0}),document.getElementById(l.declineOnBoardingProcessBtn).addEventListener("click",e=>{r.openExitConfirmationPopup(),userSignUpClog(currentDomain,"onb-flow-abandon",originPart||"homepage",l.fullPageUrl,"later","")}),document.getElementById(l.acceptOnBoardingProcessBtn).addEventListener("click",e=>{r.openStepsPopUpModals(),userSignUpClog(currentDomain,"onb-flow-proceed",originPart||"homepage",l.fullPageUrl,"lets-do-it","")}),document.querySelectorAll(l.closeModalBtn).forEach(e=>{e.addEventListener("click",e=>{r.openExitConfirmationPopup(),userSignUpClog(currentDomain,"onb-flow-abandon",originPart||"homepage",l.fullPageUrl,"button-close-x","")})}),document.querySelectorAll(l.modalBackgroundOverlay).forEach(e=>{let t="";e.addEventListener("mousedown",e=>{e=e.target||e.srcElement;MG_Utils.hasClass(e,"modalBackgroundOverlay")&&(r.openExitConfirmationPopup(),t=MG_Utils.hasClass(e,"is-hidden")&&!MG_Utils.hasClass(e,"welcome-onboardinModal")?"quit_outside_modal_"+(n+1):MG_Utils.hasClass(e,"completed-onboardingModal")?"quit_outside_modal_complete":"quit_outside_modal_"+n,r.initGtmEvent(t),userSignUpClog(currentDomain,"onb-flow-abandon",originPart||"homepage",l.fullPageUrl,"outside_modal_window","")),MG_Utils.hasClass(e,"completed-onboardingModal")&&r.completedCloseAllModals()})}),document.getElementById(l.backToCustomizeBtn).addEventListener("click",e=>{r.openStepsPopUpModals()}),document.getElementById(l.exitOnboardingConfirmBtn).addEventListener("click",()=>{r.abandonOnboardingAjaxCall(),userSignUpClog(currentDomain,"onb-flow-confirm-abandon",originPart||"homepage",l.fullPageUrl,"yes",""),document.dispatchEvent(o)}),document.querySelectorAll(l.nextButton).forEach(t=>{t.addEventListener("click",e=>{t.classList.contains("disabled-nextBtn")||t.classList.contains("inactive-btn")||t.classList.contains("error-DOFBtn")||r.nextBtn()})}),document.getElementById(l.stepOneBtn).addEventListener("click",e=>{document.querySelector(l.nextButtonInactive)||document.querySelector(l.errorDOFBtn)?r.initGtmEvent("step_1_next_error"):r.stepOneAjaxCall()}),document.getElementById(l.stepTwoBtn)&&document.getElementById(l.stepTwoBtn).addEventListener("click",e=>{r.stepTwoAjaxCall()}),document.querySelectorAll(l.subscribeBtn).forEach(e=>{e.addEventListener("click",e=>{var e=e.target,t=e.parentNode.classList.contains("buttonSubscribe")?e.parentNode.getAttribute("data-subscribe-url"):e.parentNode.getAttribute("data-unsubscribe-url"),n={type:e.parentNode.getAttribute("data-type"),id:e.parentNode.getAttribute("data-id")};r.stepThreeAjaxCall(t,n,e)})}),document.querySelectorAll(l.prevButton).forEach(e=>{e.addEventListener("click",e=>{r.prevBtn()})}),document.getElementById(l.doneAllStepsBtn).addEventListener("click",e=>{r.initGtmEvent("quiz_complete"),r.completeOnboardingAjaxCall(),r.openCompletedOnboardingPopUp(),userSignUpClog(currentDomain,"onb-flow-sub",originPart||"homepage",l.fullPageUrl,"done","")}),document.querySelectorAll(l.closeAllModalsBtn).forEach(e=>{e.addEventListener("click",e=>{r.completedCloseAllModals(),document.dispatchEvent(o)})}),[l.year,l.month,l.day].forEach(e=>{e.addEventListener("change",e=>{r.activateStepOneBtn(),r.ageChecker()})}),[l.year,l.month,l.day,l.country].forEach(e=>{e.addEventListener("change",e=>{document.querySelectorAll(l.nextButton).forEach(e=>{e.classList.remove("disabled-nextBtn")})})}),document.querySelector(l.nextButtonInactive).addEventListener("click",e=>{e.target.classList.contains("disabled-nextBtn")||r.validateBasicInformation()}),document.getElementById(l.stepTwoBtn)&&(document.getElementById("preference_women").addEventListener("click",e=>{r.showEthnicityAndCategory("women")}),document.getElementById("preference_men").addEventListener("click",e=>{r.showEthnicityAndCategory("men")}),document.getElementById("preference_trans").addEventListener("click",e=>{r.showEthnicityAndCategory("trans")}),document.querySelector(".interestedToWrapper").addEventListener("change",e=>{e=e.target;t!==e&&(r.clearCheckBoxes(),t=e)}),document.querySelectorAll(l.selectAllPill).forEach(e=>{e.addEventListener("click",e=>{var e=e.target,t=e.parentNode.getAttribute("data-id");r.checkAllEthnicities(e,t)})})),document.getElementById("js_changeYourUserName")&&(l.changeUserNameInput.addEventListener("input",()=>{r.changeUserNameAjaxCall()}),l.changeUserNameInput.addEventListener("blur",()=>{currentDeviceType&&"isMobileDevice"===currentDeviceType&&setTimeout(function(){window.scrollTo({top:0,behavior:"smooth"})},0)}))},r.openExitConfirmationPopup=()=>{r.gtmHandleButtons(n),document.querySelector("."+l.welcomeModalPopUp).classList.add("is-hidden"),document.querySelector("."+l.exitConfirmModalPopUp).classList.remove("is-hidden"),document.querySelector("."+l.onboardingStepsModalPopUp).classList.add("is-hidden"),a=!1,r.adjustEmailBannerPosition(!0,l.exitConfirmModalPopUp,0)},r.openStepsPopUpModals=()=>{document.querySelector("."+l.welcomeModalPopUp).classList.add("is-hidden"),document.querySelector("."+l.exitConfirmModalPopUp).classList.add("is-hidden"),document.querySelector("."+l.onboardingStepsModalPopUp).classList.remove("is-hidden"),r.updateStepDisplay(n),a=!0},r.adjustEmailBannerPosition=(e,t,n)=>{var a;l.emailVerificationBanner&&((a=l.emailVerificationBanner).style.top="0px",MG_Utils.removeClass(a,"behindModal"),e)&&t&&void 0!==n&&(e=(t=(e=document.querySelector("."+t))&&e.children[n]).offsetTop-(a.offsetHeight+a.offsetTop),t.offsetTop<a.offsetHeight?MG_Utils.addClass(a,"behindModal"):e<0&&(a.style.top=e+"px"))},r.openCompletedOnboardingPopUp=()=>{document.querySelector("."+l.completedOnboardingModalPopUp).classList.remove("is-hidden"),document.querySelector("."+l.onboardingStepsModalPopUp).classList.add("is-hidden"),a=!1},r.updateStepDisplay=n=>{document.querySelectorAll("."+l.stepModal).forEach((e,t)=>{e.style.display=t===n?"block":"none"}),r.adjustEmailBannerPosition(!0,l.onboardingStepsModalPopUp,n)},r.nextBtn=()=>{n<document.querySelectorAll("."+l.stepModal).length-1&&(n++,r.updateStepDisplay(n))},r.prevBtn=()=>{0<n&&(n--,r.updateStepDisplay(n))},r.stepOneAjaxCall=()=>{var e={year:l.year.value||"",month:l.month.value||"",day:l.day.value||"",country:l.country.value||"",username:l.changeUserNameInput&&l.changeUserNameInput.value?l.changeUserNameInput.value:"",token:token};MG_Utils.ajaxCall({url:"/onboarding/stepOne",type:"POST",data:e,dataType:"json",success:function(){l.changeUserNameInput&&currentUserName!==l.changeUserNameInput.value&&(l.changeUserNameInput.disabled=!0,l.responseMsgWrapper.innerHTML=userNameChangeMsg,l.responseMsgWrapper.classList.add("unavailableUserName"),l.responseMsgWrapper.classList.remove("availableUserName"),l.userProfileDataUserName.innerHTML=l.changeUserNameInput.value)}})},r.stepTwoAjaxCall=()=>{var e=document.querySelector('input[name="preference"]:checked').value.toLowerCase(),t=Array.from(document.querySelectorAll('input[name="ethnicities[]"]:checked')).map(e=>e.value),n=Array.from(document.querySelectorAll('input[name="categories[]"]:checked')).map(e=>e.value),e={preference:e,ethnicities:JSON.stringify(t),categories:JSON.stringify(n),token:token};MG_Utils.ajaxCall({url:"/onboarding/stepTwo",type:"POST",data:e,dataType:"json",success:function(){}})},r.stepThreeAjaxCall=(e,t,n)=>{MG_Utils.ajaxCall({url:e,type:"POST",data:t,dataType:"json",success:function(e){"buttonUnsubscribe"==e.class?(n.parentNode.classList.add("buttonUnsubscribe"),n.parentNode.classList.remove("buttonSubscribe"),n.classList.remove("ph-icon-add-box"),n.classList.add("ph-icon-check-square")):(n.parentNode.classList.add("buttonSubscribe"),n.parentNode.classList.remove("buttonUnsubscribe"),n.classList.remove("ph-icon-check-square"),n.classList.add("ph-icon-add-box"))}})},r.completeOnboardingAjaxCall=()=>{var e={token:token};MG_Utils.ajaxCall({url:"/onboarding/completed",type:"POST",data:e,dataType:"json",success:function(){}})},r.abandonOnboardingAjaxCall=()=>{var e={token:token};MG_Utils.ajaxCall({url:"/onboarding/abandoned",type:"POST",data:e,dataType:"json",success:function(){}})},r.completedCloseAllModals=()=>{document.querySelector("."+l.welcomeModalPopUp).classList.add("is-hidden"),document.querySelector("."+l.exitConfirmModalPopUp).classList.add("is-hidden"),document.querySelector("."+l.onboardingStepsModalPopUp).classList.add("is-hidden"),document.querySelector("."+l.completedOnboardingModalPopUp).classList.add("is-hidden"),document.body.style.overflow="revert-layer",document.getElementById("header")&&(document.getElementById("header").style.zIndex="2",document.getElementById("headerMenuContainer").style.zIndex="3"),a=!1,r.adjustEmailBannerPosition(!1);var e=document.querySelector(".emailVerHomepageContainer");e&&MG_Utils.removeClass(e,"onboarding")},r.validateBasicInformation=()=>{var e=""!==l.year.value&&""!==l.month.value&&""!==l.day.value,t=parseInt(l.year.value),n=parseInt(l.month.value),a=parseInt(l.day.value),o=new Date(l.today.getFullYear()-18,l.today.getMonth(),l.today.getDate()),t=new Date(t,n-1,a);switch(!0){case!e:l.errorMsg_1.classList.add("is-hidden"),l.errorMsg_2.classList.remove("is-hidden"),l.errorMsg_3.classList.add("is-hidden"),l.basicInformationBday.classList.add("notSelected");break;case e:l.errorMsg_1.classList.remove("is-hidden"),l.errorMsg_2.classList.add("is-hidden"),l.errorMsg_3.classList.add("is-hidden"),l.basicInformationBday.classList.remove("notSelected");break;case t>l.today||o<t:l.errorMsg_1.classList.add("is-hidden"),l.errorMsg_2.classList.add("is-hidden"),l.errorMsg_3.classList.remove("is-hidden"),l.basicInformationBday.classList.add("notSelected");break;default:l.errorMsg_1.classList.add("is-hidden"),l.errorMsg_2.classList.add("is-hidden"),l.errorMsg_3.classList.add("is-hidden"),l.basicInformationBday.classList.remove("notSelected"),document.querySelectorAll(l.nextButton).forEach(e=>{1==s&&e.classList.remove("inactive-btn")})}},r.activateStepOneBtn=()=>{var e=""!==l.year.value&&""!==l.month.value&&""!==l.day.value;switch(!0){case e&&1==s:document.querySelectorAll(l.nextButton).forEach(e=>{e.classList.remove("inactive-btn")}),l.errorMsg_1.classList.add("is-hidden"),l.errorMsg_2.classList.add("is-hidden"),l.basicInformationBday.classList.remove("notSelected");break;case e:l.basicInformationBday.classList.remove("notSelected")}},document.getElementById(l.stepTwoBtn)&&(r.showEthnicityAndCategory=e=>{document.querySelectorAll(".ethnicity-wrapper, .category-wrapper").forEach(e=>{e.style.display="none"}),document.getElementById("ethnicity-"+e).style.display="block",document.getElementById("category-"+e).style.display="block"},r.clearCheckBoxes=()=>{document.querySelectorAll(".js_ethnicitySwitch, .js_categoriesSwitch").forEach(e=>{e.checked=!1})},r.checkAllEthnicities=(t,e)=>{document.querySelectorAll(".js_ethnicitySwitch-"+e).forEach(e=>{t.checked?e.checked=!0:e.checked=!1,e.addEventListener("click",()=>{t.checked=!1})})}),r.showSubscriptionsRow=e=>{document.querySelectorAll(".subscription-wrapper").forEach(e=>{e.style.display="none"});var t=currentDeviceType&&"isDesktopDevice"===currentDeviceType?"block":"flex";document.getElementById("subscription-"+e).style.display=t},r.ageChecker=()=>{var e=parseInt(l.year.value),t=parseInt(l.month.value),n=parseInt(l.day.value),a=new Date(l.today.getFullYear()-18,l.today.getMonth(),l.today.getDate()),e=new Date(e,t-1,n);e>l.today||a<e?(document.querySelectorAll(l.nextButton).forEach(e=>{e.classList.add("error-DOFBtn")}),l.errorMsg_1.classList.add("is-hidden"),l.errorMsg_2.classList.add("is-hidden"),l.errorMsg_3.classList.remove("is-hidden"),l.basicInformationBday.classList.add("notSelected")):(document.querySelectorAll(l.nextButton).forEach(e=>{e.classList.remove("error-DOFBtn")}),l.errorMsg_3.classList.add("is-hidden"))},r.changeUserNameAjaxCall=()=>{let t=""!==l.year.value&&""!==l.month.value&&""!==l.day.value,e=l.changeUserNameInput.value,n={username:e,token:token};MG_Utils.ajaxCall({url:"/onboarding/checkUserName",type:"POST",data:n,dataType:"json",success:function(e){l.changeUserNameInput.classList.add("ajaxChangeUserNameInput"),l.responseMsgWrapper.classList.remove("is-hidden"),!0===e.status?(l.responseMsgWrapper.innerHTML=e.message,l.responseMsgWrapper.classList.add("availableUserName"),l.responseMsgWrapper.classList.remove("unavailableUserName"),s=!0,t&&document.getElementById(l.stepOneBtn).classList.remove("inactive-btn")):(l.responseMsgWrapper.innerHTML=e.error,l.responseMsgWrapper.classList.add("unavailableUserName"),l.responseMsgWrapper.classList.remove("availableUserName"),document.getElementById(l.stepOneBtn).classList.add("inactive-btn"),s=!1)}})}}}if(document.getElementById("onboardingInformation")){document.body.style.overflow="hidden",document.getElementById("header")&&(document.getElementById("header").style.zIndex="0",document.getElementById("headerMenuContainer").style.zIndex="0");try{(onboardingModalFlow=new OnboardingFlowModal).init()}catch(e){console.log(e)}let e=document.querySelectorAll(".js_mobileContainer");"undefined"!=typeof MG_Scroll&&MG_Scroll.init({width:"auto",selector:e,height:"100%",color:"#FF9000",size:"3px",alwaysVisible:!0,railVisible:!0,railOpacity:1,railColor:"transparent",distance:"2px",opacity:1,railClass:"track3",barClass:"handle3",wrapperClass:"wrapper3",wheelStep:5,enLargeOnHover:!0,enLargedSize:"4px"})}